import re
from playwright.sync_api import Playwright, sync_playwright, expect


def run(playwright: Playwright) -> None:
    browser = playwright.chromium.launch(headless=False)
    context = browser.new_context()
    page = context.new_page()
    page.goto("https://rms-ngs.net/rms/Module/User/Login.aspx")
    expect(page.get_by_role("button", name="Login")).to_be_visible()
    page.get_by_role("textbox", name="Company ID").click()
    page.get_by_role("textbox", name="Company ID").fill("96425")
    page.get_by_role("textbox", name="User Name").click()
    page.get_by_role("textbox", name="User Name").fill("cwillebrandt")
    page.get_by_role("textbox", name="Password").click()
    page.get_by_role("textbox", name="Password").fill("colin123")
    page.get_by_role("button", name="Login").click()
    page.locator("#border-1b6d6a33-e2b2-e539-1fb5-92d995438b1d").click()
    page.locator("#border-fe068648-9018-90c3-4d38-d203bd76795d").click()
    expect(page.locator("#RAD_SLIDING_PANE_ICON_ctl00_ctl44_QuickMenuSlidingPane")).to_be_visible()
    page.locator("#RAD_SLIDING_PANE_ICON_ctl00_ctl44_QuickMenuSlidingPane").click()
    page.get_by_role("link", name="Claim", exact=True).click()
    expect(page.get_by_role("button", name="Save & Go to Slideboard")).to_be_visible()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_ReportedBY_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_ReportedBY_Input").fill("property owner")
    page.get_by_text("Property Owner").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_ReferredBy_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_ReferredBy_Input").fill("willebrandt, erc-colin")
    page.get_by_text("Willebrandt, ERC-Colin").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_ProviderOffice_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_ProviderOffice_Input").fill("pdr of raleigh")
    page.get_by_text("PDR of Raleigh").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_Client_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_Client_Input").fill("Residentials")
    page.get_by_text("Residentials").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_FirstName").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_FirstName").fill("FirstNameV1")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_LastName").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_LastName").fill("LastNameV1")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_Email").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_Email").fill("testemailv1@gmail.com")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_Address_Input").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_Address_Input").fill("241 Turner Oaks Dr")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_Zip").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_Zip").fill("27519")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_MainPhone").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_TextBox_MainPhone").fill("1")
    page.get_by_role("checkbox", name="Same as Customer Address").check()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl00_EstimatorComboBox_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl00_EstimatorComboBox_Input").fill("renc")
    page.get_by_text("RENC, estimators").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl03_EstimatorComboBox_Input").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl03_EstimatorComboBox_Input").fill("none")
    page.get_by_text("None").first.click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl06_EstimatorComboBox_Input").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl06_EstimatorComboBox_Input").fill("willebran")
    page.get_by_text("Willebran", exact=True).click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl01_EstimatorComboBox_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl01_EstimatorComboBox_Input").fill("essence")
    page.get_by_text("Reescano, Essence").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl04_EstimatorComboBox_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl04_EstimatorComboBox_Input").fill("rhonda")
    page.get_by_text("Rhonda").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl02_EstimatorComboBox_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl02_EstimatorComboBox_Input").fill("none")
    page.get_by_text("None").nth(1).click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl05_EstimatorComboBox_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl05_EstimatorComboBox_Input").fill("willebr")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_InternalParticpantsControl_InternalParticipantsList_ctl05_EstimatorComboBox_DropDown").get_by_text("Willebrandt, Colin").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_2_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_2_Input").fill("pdr")
    page.get_by_text("PDR-KHTX-JCA").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_4_Arrow").click()
    page.get_by_text("JCA, JCA").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_3_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_3_Input").fill("self")
    page.get_by_text("Self").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_3_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_3_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_3_Input").fill("")
    page.get_by_text("Pay, Self").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_34_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_34_DropDown").get_by_text("Pay, Self").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_24_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_24_Input").fill("pdr")
    page.get_by_text("PDR-RENC").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_33_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemIndividualParticipantCombobox_33_Input").fill("jason")
    page.get_by_text("Jason").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_10_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_10_Input").fill("pdr")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_10_DropDown").get_by_text("PDR-KHTX").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_23_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_ExternalParticipants_SystemCompanyParticipantCombobox_23_Input").fill("no tp")
    page.get_by_text("No TPA").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DatePicker_DateOffLoss_dateInput").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DatePicker_DateOffLoss_dateInput").fill("08/14/2025")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_JobNameRadTextBox").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_JobNameRadTextBox").fill("LastNamev1, FirstNameV1")
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_LossType_Arrow").click()
    page.locator("#ctl00_ContentPlaceHolder1_ProviderCreateClaim_DropDown_LossType_Input").fill("water")
    page.get_by_text("Water - Sewer Backup, Black,").click()
    page.get_by_role("checkbox", name="Appraisal/Consulting").check()
    page.get_by_role("textbox", name="Enter Loss Description").click()
    page.get_by_role("textbox", name="Enter Loss Description").fill("Loss Description")
    page.get_by_role("button", name="Save & Go to Slideboard").click()
    expect(page.get_by_role("button", name="Create Claim")).to_be_visible()

    # ---------------------
    context.close()
    browser.close()


with sync_playwright() as playwright:
    run(playwright)
